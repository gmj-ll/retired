# 交互功能使用指南

## 新增功能概览

### 🎨 视觉优化
1. **图标系统**: 使用 Ionicons 替换所有箭头图标
2. **颜色优化**: 高对比度配色方案，提升可读性
3. **界面美化**: 更专业的视觉设计

### 🖱️ 交互增强
1. **圆环拖拽**: 直接拖拽调整时间分配
2. **实时反馈**: 拖拽时的视觉反馈
3. **智能约束**: 合理的时间分配限制

## 详细功能说明

### 1. 图标系统更新

#### Tab 导航图标
- **首页**: `home` / `home-outline`
- **分析**: `analytics` / `analytics-outline` 
- **设置**: `settings` / `settings-outline`

#### 功能图标
- **日历**: `calendar-outline` - 查看历史数据
- **洞察**: `bulb-outline` - 时间洞察提示

### 2. 颜色方案优化

#### 新配色方案
```typescript
colors = {
  work: '#FF6B6B',    // 红色 - 工作时间
  sleep: '#9B59B6',   // 紫色 - 睡眠时间  
  free: '#2ECC71'     // 绿色 - 自由时间
}
```

#### 优化理由
- **高对比度**: 紫色和绿色对比明显，易于区分
- **色彩心理学**: 红色代表工作压力，紫色代表休息，绿色代表自由
- **无障碍设计**: 考虑色盲用户的使用体验

### 3. 圆环拖拽功能

#### 使用方法
1. **进入编辑模式**: 当日圆环默认可编辑
2. **拖拽调整**: 点击并拖拽圆环任意区域
3. **实时预览**: 拖拽时实时显示新的时间分配
4. **自动保存**: 松开手指后自动保存更改

#### 技术实现
```typescript
// 手势识别
const onGestureEvent = (event: any) => {
  const { x, y, state } = event.nativeEvent;
  const angle = getAngleFromPoint(x, y);
  
  if (state === State.BEGAN) {
    setDragType(getTimeTypeFromAngle(angle));
  } else if (state === State.ACTIVE) {
    // 实时调整时间分配
    updateTimeDistribution(angle);
  }
};
```

#### 智能约束
- **最小值**: 每个时间段最少5%（1.2小时）
- **最大值**: 每个时间段最多80%（19.2小时）
- **总和**: 三个时间段总和始终为100%
- **比例调整**: 调整一个时间段时，其他时间段按比例自动调整

### 4. 交互反馈

#### 视觉反馈
- **拖拽状态**: 被拖拽的圆环段透明度降低至80%
- **中心提示**: 显示"调整中..."状态
- **实时数值**: 拖拽时实时更新小时数

#### 触觉反馈（计划中）
- 开始拖拽时的轻微震动
- 达到边界值时的提醒震动

## 使用场景

### 1. 日常时间规划
- 根据实际作息调整时间分配
- 可视化时间使用情况
- 制定更合理的作息计划

### 2. 工作生活平衡
- 直观看到工作与生活的比例
- 调整工作时间，增加自由时间
- 优化睡眠时间分配

### 3. 目标设定
- 设定理想的时间分配目标
- 对比当前与目标的差距
- 逐步调整达到理想状态

## 技术特性

### 性能优化
- **流畅拖拽**: 60fps 的拖拽响应
- **内存控制**: 避免频繁的状态更新
- **计算优化**: 高效的角度和比例计算

### 用户体验
- **直观操作**: 所见即所得的编辑体验
- **容错设计**: 防止不合理的时间分配
- **状态保持**: 编辑结果自动保存

### 扩展性
- **颜色自定义**: 支持用户自定义颜色主题
- **精度调整**: 可调整时间显示精度
- **数据同步**: 支持云端数据同步（计划中）

## 故障排除

### 拖拽不响应
1. 确保 GestureHandlerRootView 正确配置
2. 检查 PanGestureHandler 是否正常工作
3. 验证触摸事件是否被其他组件拦截

### 颜色显示异常
1. 检查颜色值格式是否正确
2. 确认设备是否支持所需颜色
3. 验证 SVG 渲染是否正常

### 数据不同步
1. 检查 onTimeChange 回调是否正确触发
2. 验证状态更新逻辑
3. 确认数据持久化是否正常

## 未来改进

### 短期计划
- [ ] 添加撤销/重做功能
- [ ] 实现预设时间模板
- [ ] 增加拖拽边界提示

### 长期计划
- [ ] 多设备数据同步
- [ ] AI 智能时间建议
- [ ] 社交分享功能

---

*交互功能指南版本: v1.1.0*
*最后更新: 2026-01-30*
