# 首次参加工作日期功能

## 功能概述

为退休倒计时应用添加了首次参加工作日期字段，用于更精确地计算退休时间，特别是对特殊工种的退休政策计算。

## 新增功能

### 1. 用户信息扩展
- 在 `UserProfile` 类型中添加了 `workStartDate?: Date` 字段
- 用户可以在注册和设置中输入首次参加工作的具体日期

### 2. 退休政策计算优化
- 特殊工种退休年龄现在会根据工作年限进行调整
- 工作年限不足10年的特殊工种将按一般职工退休年龄计算
- 退休政策说明中会显示当前工作年限和相关要求

### 3. 用户界面更新

#### 注册流程 (OnboardingScreen)
- 添加了"首次参加工作日期"输入字段
- 包含年、月、日的详细输入
- 添加了日期验证逻辑，确保工作开始日期不早于出生日期

#### 设置页面 (SettingsScreen)
- 在个人信息显示中添加了参加工作日期
- 在编辑模式中可以修改参加工作日期
- 保存时会重新计算退休信息

### 4. 政策计算逻辑

#### 特殊工种规则
- 男性和女性特殊工种都需要工作满10年才能享受提前退休
- 工作年限不足时，按一般职工退休年龄执行
- 在政策说明中会显示当前工作年限和要求

#### 计算示例
```typescript
// 示例1: 特殊工种，工作年限足够
birthDate: 1980-01-01
workStartDate: 2000-01-01  // 工作24年
jobType: 'special'
gender: 'male'
// 结果: 55岁退休

// 示例2: 特殊工种，工作年限不足
birthDate: 1990-01-01
workStartDate: 2020-01-01  // 工作4年
jobType: 'special'
gender: 'female'
// 结果: 50岁退休（按一般职工）
```

## 技术实现

### 文件修改
1. `src/types/index.ts` - 添加 workStartDate 字段
2. `src/screens/OnboardingScreen.tsx` - 添加工作日期输入UI
3. `src/screens/SettingsScreen.tsx` - 添加工作日期显示和编辑
4. `src/services/RetirementPolicyService.ts` - 更新退休计算逻辑
5. `src/test/workStartDateTest.ts` - 添加功能测试

### 新增方法
- `RetirementPolicyService.calculateWorkYears()` - 计算工作年限
- 更新的 `RetirementPolicyService.calculateRetirement()` - 考虑工作年限
- 更新的 `RetirementPolicyService.getPolicyExplanation()` - 包含工作年限说明

## 用户体验

### 注册流程
1. 用户输入基本信息（姓名、性别）
2. 输入出生日期
3. **新增**: 输入首次参加工作日期
4. 选择职业类型
5. 系统自动计算退休信息并显示政策说明

### 设置页面
- 显示参加工作日期信息
- 可以编辑和更新工作日期
- 修改后自动重新计算退休时间

## 验证和测试

创建了专门的测试文件 `workStartDateTest.ts`，包含：
- 特殊工种工作年限足够的情况
- 特殊工种工作年限不足的情况  
- 一般职工不受工作年限影响的情况

## 注意事项

1. 工作开始日期为可选字段，向后兼容现有用户数据
2. 只有特殊工种会受到工作年限限制影响
3. 日期验证确保数据的合理性
4. 政策计算基于中国现行退休制度，实际政策以官方为准

## 未来扩展

可以考虑添加：
- 更复杂的工作年限计算（考虑中断、调岗等）
- 不同特殊工种的具体年限要求
- 工作履历管理功能
