# Widget çœŸæœºæµ‹è¯•æ¸…å•

## âœ… å·²å®Œæˆçš„é…ç½®

### 1. containerBackground API
- âœ… å·²æ·»åŠ  `containerBackground(for: .widget)` ä¿®é¥°ç¬¦
- âœ… èƒŒæ™¯è§†å›¾å·²æå–ä¸ºç‹¬ç«‹çš„ `@ViewBuilder`
- âœ… æ”¯æŒè‡ªå®šä¹‰èƒŒæ™¯å›¾ç‰‡å’Œé»˜è®¤æ¸å˜

### 2. App Group é…ç½®
- âœ… App Group ID: `group.mengji.retirement.app.2026`
- âœ… ä¸»åº”ç”¨ entitlements å·²é…ç½®
- âœ… Widget Extension entitlements å·²é…ç½®
- âœ… æ•°æ®è¯»å†™æ¨¡å—å·²é…ç½®

### 3. è°ƒè¯•åŠŸèƒ½
- âœ… æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—è¾“å‡º
- âœ… åˆ›å»ºäº†è°ƒè¯•è„šæœ¬ `ios/DebugWidgetData.swift`
- âœ… å¢å¼ºäº†é”™è¯¯å¤„ç†

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æ­¥éª¤ 1: æ¸…ç†å¹¶æ„å»º
```bash
cd ios
rm -rf build
pod install
```

### æ­¥éª¤ 2: åœ¨ Xcode ä¸­è¿è¡Œ
1. æ‰“å¼€ `ios/app.xcworkspace`
2. é€‰æ‹©çœŸæœºè®¾å¤‡ï¼ˆä¸æ˜¯æ¨¡æ‹Ÿå™¨ï¼‰
3. Product â†’ Clean Build Folder (â‡§âŒ˜K)
4. Product â†’ Build (âŒ˜B)
5. ç¡®è®¤æ²¡æœ‰ç¼–è¯‘é”™è¯¯

### æ­¥éª¤ 3: è¿è¡Œä¸»åº”ç”¨
1. ç‚¹å‡» Run (âŒ˜R)
2. åº”ç”¨å¯åŠ¨åï¼Œå¡«å†™ä¸ªäººä¿¡æ¯ï¼š
   - å§“å
   - å‡ºç”Ÿæ—¥æœŸ
   - å·¥ä½œå¼€å§‹æ—¥æœŸ
   - é€€ä¼‘æ—¥æœŸ
   - ï¼ˆå¯é€‰ï¼‰ä¸Šä¼ èƒŒæ™¯å›¾ç‰‡
3. ä¿å­˜ä¿¡æ¯

### æ­¥éª¤ 4: æŸ¥çœ‹æ—¥å¿—
åœ¨ Xcode Console ä¸­åº”è¯¥çœ‹åˆ°ï¼š
```
Widget data updated successfully
```

### æ­¥éª¤ 5: æ·»åŠ  Widget
1. å›åˆ°ä¸»å±å¹•
2. é•¿æŒ‰ç©ºç™½åŒºåŸŸ
3. ç‚¹å‡»å·¦ä¸Šè§’ "+" æŒ‰é’®
4. æœç´¢ "é€€ä¼‘å€’è®¡æ—¶"
5. é€‰æ‹©ä¸­ç­‰å°ºå¯¸ Widget
6. æ·»åŠ åˆ°ä¸»å±å¹•

### æ­¥éª¤ 6: éªŒè¯æ˜¾ç¤º
Widget åº”è¯¥æ˜¾ç¤ºï¼š
- âœ… æ­£ç¡®çš„å§“åï¼ˆ"ä½ å¥½ï¼ŒXXX"ï¼‰
- âœ… å‡†ç¡®çš„å€’è®¡æ—¶æ•°å­—
- âœ… æ­£ç¡®çš„å•ä½ï¼ˆå¤©/æœˆ/å¹´ç­‰ï¼‰
- âœ… è¿›åº¦æ¡å’Œç™¾åˆ†æ¯”
- âœ… èƒŒæ™¯å›¾ç‰‡æˆ–æ¸å˜èƒŒæ™¯

### æ­¥éª¤ 7: æŸ¥çœ‹ Widget æ—¥å¿—
1. Window â†’ Devices and Simulators
2. é€‰æ‹©ä½ çš„è®¾å¤‡
3. ç‚¹å‡» "Open Console"
4. åœ¨æœç´¢æ¡†è¾“å…¥ "Widget:"
5. åº”è¯¥çœ‹åˆ°ï¼š
```
âœ… Widget: Successfully loaded data from App Group
âœ… Widget: All required fields found
âœ… Widget: Entry created successfully with calculated time: XXX å¤©
```

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1: Widget æ˜¾ç¤º"è¯·æ‰“å¼€åº”ç”¨"
**åŸå› ï¼š** æ•°æ®æœªå†™å…¥æˆ–æ— æ³•è¯»å–

**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¡®è®¤ä¸»åº”ç”¨å·²è¿è¡Œå¹¶ä¿å­˜äº†æ•°æ®
2. æ£€æŸ¥ Xcode Console æ˜¯å¦æœ‰é”™è¯¯
3. è¿è¡Œè°ƒè¯•è„šæœ¬éªŒè¯æ•°æ®

### é—®é¢˜ 2: ç¼–è¯‘é”™è¯¯ "containerBackground is only available in iOS 17.0"
**åŸå› ï¼š** Deployment Target ç‰ˆæœ¬è¿‡ä½

**è§£å†³æ–¹æ¡ˆï¼š**
1. åœ¨ Xcode ä¸­é€‰æ‹© Widget Extension target
2. General â†’ Deployment Info
3. è®¾ç½® iOS Deployment Target ä¸º 17.0 æˆ–æ›´é«˜

### é—®é¢˜ 3: Widget æ˜¾ç¤º"æ•°æ®ä¸å®Œæ•´"
**åŸå› ï¼š** ç¼ºå°‘å¿…éœ€å­—æ®µ

**è§£å†³æ–¹æ¡ˆï¼š**
1. åœ¨ä¸»åº”ç”¨ä¸­é‡æ–°ä¿å­˜ä¸ªäººä¿¡æ¯
2. ç¡®è®¤æ‰€æœ‰å­—æ®µéƒ½å·²å¡«å†™
3. æŸ¥çœ‹æ—¥å¿—ç¡®è®¤æ•°æ®å†™å…¥æˆåŠŸ

### é—®é¢˜ 4: èƒŒæ™¯å›¾ç‰‡ä¸æ˜¾ç¤º
**åŸå› ï¼š** å›¾ç‰‡è·¯å¾„æˆ–æƒé™é—®é¢˜

**è§£å†³æ–¹æ¡ˆï¼š**
1. é‡æ–°ä¸Šä¼ èƒŒæ™¯å›¾ç‰‡
2. æ£€æŸ¥å›¾ç‰‡æ˜¯å¦ä¿å­˜åœ¨å…±äº«å®¹å™¨ä¸­
3. æŸ¥çœ‹æ—¥å¿—ä¸­çš„å›¾ç‰‡è·¯å¾„

## ğŸ“Š é¢„æœŸæ—¥å¿—è¾“å‡º

### ä¸»åº”ç”¨æ—¥å¿—
```
Widget data updated successfully
```

### Widget æ—¥å¿—ï¼ˆæˆåŠŸï¼‰
```
âœ… Widget: Successfully loaded data from App Group
Widget data keys: ["name", "retirementDate", "currentFormat", "progress", "profileImage"]
âœ… Widget: All required fields found
Name: å¼ ä¸‰, Format: days, Progress: 0.65
âœ… Widget: Entry created successfully with calculated time: 365 å¤©
```

### Widget æ—¥å¿—ï¼ˆå¤±è´¥ï¼‰
```
âŒ Widget: Failed to load data from App Group
```
æˆ–
```
âŒ Widget: Missing required fields in widgetData
```

## ğŸ”§ è°ƒè¯•å·¥å…·ä½¿ç”¨

### ä½¿ç”¨ DebugWidgetData.swift
1. åœ¨ Xcode ä¸­æ‰“å¼€ `ios/DebugWidgetData.swift`
2. åœ¨ä¸»åº”ç”¨çš„æŸä¸ªåœ°æ–¹ä¸´æ—¶æ·»åŠ è¿™æ®µä»£ç 
3. è¿è¡Œåº”ç”¨æŸ¥çœ‹è¾“å‡º
4. è„šæœ¬ä¼šæ˜¾ç¤ºï¼š
   - App Group è®¿é—®çŠ¶æ€
   - æ‰€æœ‰å­˜å‚¨çš„æ•°æ®
   - ç¼ºå¤±çš„å­—æ®µ
   - èƒŒæ™¯å›¾ç‰‡çŠ¶æ€
   - å…±äº«å®¹å™¨è·¯å¾„

## ğŸ“± è®¾å¤‡è¦æ±‚

- iOS 17.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- çœŸæœºè®¾å¤‡ï¼ˆWidget åœ¨æ¨¡æ‹Ÿå™¨ä¸Šå¯èƒ½æœ‰é™åˆ¶ï¼‰
- æœ‰æ•ˆçš„å¼€å‘è€…è´¦å·ï¼ˆæ”¯æŒ App Groupsï¼‰

## ğŸ¯ æˆåŠŸæ ‡å‡†

Widget æ­£å¸¸å·¥ä½œåº”æ»¡è¶³ï¼š
- [x] ç¼–è¯‘æ— é”™è¯¯
- [x] ä¸»åº”ç”¨èƒ½æˆåŠŸå†™å…¥æ•°æ®
- [x] Widget èƒ½è¯»å–æ•°æ®
- [x] æ˜¾ç¤ºæ­£ç¡®çš„ä¸ªäººä¿¡æ¯
- [x] å€’è®¡æ—¶è®¡ç®—å‡†ç¡®
- [x] èƒŒæ™¯æ˜¾ç¤ºæ­£å¸¸
- [x] è¿›åº¦æ¡å·¥ä½œæ­£å¸¸
- [x] æ¯å°æ—¶è‡ªåŠ¨æ›´æ–°

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. Xcode Console çš„å®Œæ•´æ—¥å¿—
2. Widget çš„æˆªå›¾
3. iOS ç‰ˆæœ¬å’Œè®¾å¤‡å‹å·
4. é”™è¯¯ä¿¡æ¯çš„æˆªå›¾

## ğŸ‰ æµ‹è¯•å®Œæˆå

å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼š
1. Widget åº”è¯¥å®æ—¶æ˜¾ç¤ºé€€ä¼‘å€’è®¡æ—¶
2. æ¯æ¬¡æ‰“å¼€åº”ç”¨æ›´æ–°æ•°æ®åï¼ŒWidget ä¼šè‡ªåŠ¨åˆ·æ–°
3. å¯ä»¥åˆ‡æ¢ä¸åŒçš„æ—¶é—´æ ¼å¼ï¼ˆå¤©/æœˆ/å¹´ç­‰ï¼‰
4. èƒŒæ™¯å›¾ç‰‡ä¼šæ­£ç¡®æ˜¾ç¤º

ç¥æµ‹è¯•é¡ºåˆ©ï¼ğŸš€
